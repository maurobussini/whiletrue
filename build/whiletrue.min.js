//! whiletrue
//! Start/stop/pause/repeat: task runner in Javascript
//! version : 1.1.1
//! authors : maurobussini
//! license : MIT
//! built   : 2015-09-07
//! https://github.com/maurobussini/whiletrue
!function(a,b){"function"==typeof define&&define.amd?define(["q"],b):"object"==typeof exports?module.exports=b(require("q")):a.whiletrue=b(a.Q)}(this,function(a){function b(b,c,d){function e(b){var c=a.defer();return setTimeout(function(){h(b).then(function(a){i.iterations++;var d={iterations:i.iterations,delay:b.delay,index:b.index,time:a};c.resolve(d)})},i.delay),c.promise}function f(){for(var b=a.defer(),c=[],d={iterations:i.iterations,delay:i.delay,index:0};i.condition(d);){var f=e(d);c.push(f),d={iterations:i.iterations,delay:i.delay,index:c.length}}return a.all(c).then(function(a){b.resolve(a)}),b.promise}function g(){var b=a.defer(),c=[],d=function(){var a={iterations:i.iterations,delay:i.delay,index:c.length},e=i.condition(a);0==e?b.resolve(c):h(a).then(function(a){i.iterations++;var b={iterations:i.iterations,delay:i.delay,index:c.length,time:a};c.push(b),setTimeout(d,i.delay)})};return d(),b.promise}function h(b){var c=a.defer(),d=new Date;return b.timer={start:d,duration:null},i.task(function(){var a={start:d,duration:new Date-d};c.resolve(a)},b),c.promise}if(!b)throw new Error("Argument 'condition' is invalid");if(!c)throw new Error("Argument 'task' is invalid");if(!d)throw new Error("Argument 'delay' is invalid");if("function"!=typeof b)throw new Error("Condition must be a function");if("function"!=typeof c)throw new Error("Task must be a function");if("number"!=typeof d)throw new Error("Delay must be a number");if(0>=d)throw new Error("Delay must be a number greater then zero");var i=this;return i.delay=d,i.condition=b,i.task=c,i.iterations=0,i.run=g,i.runParallel=f,i}function c(a,c,d){return new b(a,c,d)}if(!a)throw new Error("whiletrue requires 'Q' library");return c});